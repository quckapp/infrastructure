# =============================================================================
# QUCKAPP SECRETS
# =============================================================================
# NOTE: These are placeholder secrets for development.
# In production, use:
# - Azure Key Vault with CSI driver
# - Sealed Secrets
# - External Secrets Operator
# =============================================================================

# =============================================================================
# DATABASE SECRETS
# =============================================================================
apiVersion: v1
kind: Secret
metadata:
  name: quckapp-database-secrets
  namespace: quckapp
  labels:
    app.kubernetes.io/name: quckapp
    app.kubernetes.io/component: database-secrets
type: Opaque
stringData:
  # MongoDB
  MONGODB_USERNAME: "quckapp"
  MONGODB_PASSWORD: "CHANGE_ME_IN_PRODUCTION"
  MONGODB_URI: "mongodb://quckapp:CHANGE_ME_IN_PRODUCTION@mongodb.quckapp.svc.cluster.local:27017/quckapp"

  # MySQL
  MYSQL_USERNAME: "quckapp"
  MYSQL_PASSWORD: "CHANGE_ME_IN_PRODUCTION"
  MYSQL_ROOT_PASSWORD: "CHANGE_ME_IN_PRODUCTION"

  # PostgreSQL
  POSTGRES_USERNAME: "quckapp"
  POSTGRES_PASSWORD: "CHANGE_ME_IN_PRODUCTION"

  # Redis
  REDIS_PASSWORD: "CHANGE_ME_IN_PRODUCTION"

  # Elasticsearch
  ELASTICSEARCH_USERNAME: "elastic"
  ELASTICSEARCH_PASSWORD: "CHANGE_ME_IN_PRODUCTION"
---
# =============================================================================
# JWT SECRETS
# =============================================================================
apiVersion: v1
kind: Secret
metadata:
  name: quckapp-jwt-secrets
  namespace: quckapp
  labels:
    app.kubernetes.io/name: quckapp
    app.kubernetes.io/component: jwt-secrets
type: Opaque
stringData:
  JWT_SECRET: "CHANGE_ME_IN_PRODUCTION_USE_64_CHAR_RANDOM_STRING"
  JWT_REFRESH_SECRET: "CHANGE_ME_IN_PRODUCTION_USE_64_CHAR_RANDOM_STRING"
---
# =============================================================================
# ENCRYPTION SECRETS
# =============================================================================
apiVersion: v1
kind: Secret
metadata:
  name: quckapp-encryption-secrets
  namespace: quckapp
  labels:
    app.kubernetes.io/name: quckapp
    app.kubernetes.io/component: encryption-secrets
type: Opaque
stringData:
  ENCRYPTION_KEY: "CHANGE_ME_IN_PRODUCTION_USE_32_CHAR"
  SECRET_KEY_BASE: "CHANGE_ME_IN_PRODUCTION_USE_64_CHAR_RANDOM_STRING_FOR_ELIXIR"
---
# =============================================================================
# MESSAGE BROKER SECRETS
# =============================================================================
apiVersion: v1
kind: Secret
metadata:
  name: quckapp-broker-secrets
  namespace: quckapp
  labels:
    app.kubernetes.io/name: quckapp
    app.kubernetes.io/component: broker-secrets
type: Opaque
stringData:
  KAFKA_SASL_USERNAME: "quckapp"
  KAFKA_SASL_PASSWORD: "CHANGE_ME_IN_PRODUCTION"
  RABBITMQ_USERNAME: "quckapp"
  RABBITMQ_PASSWORD: "CHANGE_ME_IN_PRODUCTION"
---
# =============================================================================
# EXTERNAL SERVICE SECRETS
# =============================================================================
apiVersion: v1
kind: Secret
metadata:
  name: quckapp-external-secrets
  namespace: quckapp
  labels:
    app.kubernetes.io/name: quckapp
    app.kubernetes.io/component: external-secrets
type: Opaque
stringData:
  # Monitoring
  SENTRY_DSN: ""
  DATADOG_API_KEY: ""
  NEWRELIC_LICENSE_KEY: ""

  # Firebase
  FIREBASE_PROJECT_ID: ""
  FIREBASE_PRIVATE_KEY: ""
  FIREBASE_CLIENT_EMAIL: ""

  # Twilio
  TWILIO_ACCOUNT_SID: ""
  TWILIO_AUTH_TOKEN: ""

  # OpenAI
  OPENAI_API_KEY: ""

  # OAuth
  GOOGLE_CLIENT_ID: ""
  GOOGLE_CLIENT_SECRET: ""
  FACEBOOK_APP_ID: ""
  FACEBOOK_APP_SECRET: ""
---
# =============================================================================
# AZURE KEY VAULT SECRET PROVIDER CLASS
# =============================================================================
# Use this with Azure Key Vault CSI driver for production
apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: quckapp-keyvault-secrets
  namespace: quckapp
spec:
  provider: azure
  parameters:
    usePodIdentity: "false"
    useVMManagedIdentity: "true"
    userAssignedIdentityID: ""  # Set from Terraform output
    keyvaultName: ""            # Set from Terraform output
    tenantId: ""                # Set from Terraform output
    objects: |
      array:
        - |
          objectName: jwt-secret
          objectType: secret
        - |
          objectName: jwt-refresh-secret
          objectType: secret
        - |
          objectName: encryption-key
          objectType: secret
  secretObjects:
    - secretName: quckapp-keyvault-synced
      type: Opaque
      data:
        - objectName: jwt-secret
          key: JWT_SECRET
        - objectName: jwt-refresh-secret
          key: JWT_REFRESH_SECRET
        - objectName: encryption-key
          key: ENCRYPTION_KEY
